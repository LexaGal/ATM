A[0]=1, A[i]=0 для всех i>0,
KOL[0]=0, KOL[i]=254, для всех i>0, 
(считаем, что если KOL[i]=254, то сумму i набрать нельзя),
PredSum[i]=0 для всех i>0;

for i:=1 to N do {цикл по всем купюрам}
begin

	for j:=M[i] to P 
	{цикл по всем возможным суммам с участием купюры M[i]}

		if (A[j-M[i]]<>0) and{если можно набрать сумму j-M[i]}
		(KOL[j]>KOL[j-M[i]]+1) 
		{и добавлением купюры M[i] мы получаем сумму 
		j из меньшего количества купюр}

		then begin

			KOL[j]:=KOL[j-M[i]]+1 {то запоминаем это новое количество и
			 в B[j] заносим новую}
			B[j]:=j-M[i];{информацию о предыдущей сумме}
			A[j]:=1;{и помечаем, что сумму j набрать можно} end

		else B[i]:=PredSum[j]; {иначе дублируем старую информацию} 

	for j:=M[i] to P do {Дублируем информацию из B} 
	PredSum[j]:=B[j]; {в PredSum}

end;